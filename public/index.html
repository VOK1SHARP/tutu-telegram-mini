<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#4CAF50" media="(prefers-color-scheme: light)">
    <meta name="theme-color" content="#1E1E1E" media="(prefers-color-scheme: dark)">
    <title>–¢–ò‚Ä¢–¢–ò - –ß–∞–π–Ω–∞—è –ª–∞–≤–∫–∞</title>
    <meta name="description" content="–û–Ω–ª–∞–π–Ω-–∑–∞–∫–∞–∑ –∫–∏—Ç–∞–π—Å–∫–æ–≥–æ —á–∞—è –≤ Telegram Mini App">
    <link rel="stylesheet" href="style.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="manifest" href="manifest.json">
    
    <style>
        /* iOS Specific Fixes */
        :root {
            --safe-area-top: env(safe-area-inset-top, 0px);
            --safe-area-bottom: env(safe-area-inset-bottom, 0px);
            --vh: 1vh;
        }
        
        .quick-loader {
            position: fixed;
            inset: 0;
            background: linear-gradient(135deg, #4CAF50, #2E7D32);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            color: white;
            text-align: center;
        }
        .quick-loader i {
            font-size: 60px;
            margin-bottom: 20px;
            animation: spin 2s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* –§–∏–∫—Å –¥–ª—è 100vh –Ω–∞ iOS */
        .min-height-ios {
            min-height: -webkit-fill-available;
            min-height: 100vh;
        }
        
        /* –ê–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü */
        .page-enter {
            animation: pageEnter 0.3s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }
        
        .page-exit {
            animation: pageExit 0.3s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }
        
        @keyframes pageEnter {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes pageExit {
            from {
                opacity: 1;
                transform: translateX(0);
            }
            to {
                opacity: 0;
                transform: translateX(-30px);
            }
        }
    </style>
</head>
<body class="min-height-ios">
    <div class="quick-loader">
        <div>
            <i class="fas fa-leaf"></i>
            <h2>–¢–ò‚Ä¢–¢–ò</h2>
            <p>–ó–∞–≥—Ä—É–∂–∞–µ–º —á–∞–π–Ω—É—é –≥–∞—Ä–º–æ–Ω–∏—é...</p>
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä -->
    <div id="app" style="display: none;">
        <!-- –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ -->
        <div id="main-page" class="page active"></div>
        
        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∫–∞—Ç–∞–ª–æ–≥–∞ -->
        <div id="catalog-page" class="page"></div>
        
        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç–æ–≤–∞—Ä–∞ -->
        <div id="product-page" class="page"></div>
        
        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∫–æ—Ä–∑–∏–Ω—ã -->
        <div id="cart-page" class="page"></div>
        
        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–∫–∞–∑–æ–≤ -->
        <div id="orders-page" class="page"></div>
        
        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–æ—Ñ–∏–ª—è -->
        <div id="profile-page" class="page"></div>
    </div>

    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
    <div id="notification-container"></div>

    <script src="app.js"></script>
    
    <script>
        // –§–∏–∫—Å –¥–ª—è viewport –Ω–∞ iOS
        function fixViewportHeight() {
            const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
            if (isIOS) {
                const vh = window.innerHeight * 0.01;
                document.documentElement.style.setProperty('--vh', `${vh}px`);
                document.body.classList.add('ios-device');
                
                // –§–∏–∫—Å –¥–ª—è Telegram WebApp –Ω–∞ iOS
                if (window.Telegram && Telegram.WebApp) {
                    Telegram.WebApp.viewportHeight = window.innerHeight;
                }
            }
        }
        
        window.addEventListener('load', function() {
            fixViewportHeight();
            
            setTimeout(() => {
                const loader = document.querySelector('.quick-loader');
                if (loader) {
                    loader.style.transition = 'opacity 0.5s';
                    loader.style.opacity = '0';
                    setTimeout(() => {
                        loader.style.display = 'none';
                        const app = document.getElementById('app');
                        if (app) app.style.display = 'block';
                        
                        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏
                        if (typeof initApp === 'function') {
                            initApp();
                        }
                    }, 500);
                }
            }, 500);
        });
        
        window.addEventListener('resize', fixViewportHeight);
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–º–Ω–æ–π —Ç–µ–º—ã (—Ç–æ–ª—å–∫–æ —Å–∏—Å—Ç–µ–º–Ω–æ–π, –±–µ–∑ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è)
        (function initSystemTheme() {
            const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)');
            
            const applySystemTheme = (isDark) => {
                const savedTheme = localStorage.getItem('tea_theme');
                // –ü—Ä–∏–º–µ–Ω—è–µ–º —Å–∏—Å—Ç–µ–º–Ω—É—é —Ç–µ–º—É —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤—ã–±—Ä–∞–ª —Ä—É—á–Ω—É—é
                if (!savedTheme || savedTheme === 'auto') {
                    if (isDark) {
                        document.body.classList.add('dark-theme');
                    } else {
                        document.body.classList.remove('dark-theme');
                    }
                }
            };
            
            applySystemTheme(prefersDarkScheme.matches);
            
            prefersDarkScheme.addEventListener('change', (e) => {
                applySystemTheme(e.matches);
            });
        })();
    </script>
    <script>
    // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
    function detectDevice() {
        const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
        const isAndroid = /Android/.test(navigator.userAgent);
        
        if (isIOS) {
            document.body.classList.add('ios-device');
            console.log('üì± iOS —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ');
        }
        if (isAndroid) {
            document.body.classList.add('android-device');
            console.log('üì± Android —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ');
        }
    }
    
    // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    window.addEventListener('load', detectDevice);
</script>
</body>
</html>
